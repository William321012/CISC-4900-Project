<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <style>
        .content > div{
           display: inline-block;
            border-radius: 8px;
            overflow: hidden;
            transition: all 0.2s;
            background-color: lightblue;
            margin: 10px;
            padding: 8px;
        }

        .content > div:hover{
            transform: scale(105%);
        }


        .filter > div{
            border-radius: 4px;
            background-color:lightskyblue;
            margin: 4px;
            padding: 4px;
            display: inline-block;

        }
    </style>
</head>

<div id="filter" class="filter">
    <div>
        brand: <br>
        Nike<input type="checkbox" id="Nike" onclick="updateFilter()"><br>
        Supreme<input type="checkbox" id="Supreme" onclick="updateFilter()"><br>
        Prada<input type="checkbox" id="Prada" onclick="updateFilter()"><br>
        Gucci<input type="checkbox" id="Gucci" onclick="updateFilter()"><br>
    </div>

    <div>
        size:<br>
        S:<input type="checkbox" id="S" onclick="updateFilter()"><br>
        M:<input type="checkbox" id="M" onclick="updateFilter()"><br>
        L:<input type="checkbox" id="L" onclick="updateFilter()"><br>
        XL:<input type="checkbox" id="XL" onclick="updateFilter()"><br>
    </div>

    <div>
        condition:<br>
        New:<input type="checkbox" id="New" onclick="updateFilter()"><br>
        Like New:<input type="checkbox" id="LikeNew" onclick="updateFilter()"><br>
        Very good:<input type="checkbox" id="VeryGood" onclick="updateFilter()"><br>
        Good:<input type="checkbox" id="Good" onclick="updateFilter()"><br>
        Fair:<input type="checkbox" id="Fair" onclick="updateFilter()"><br>
    </div>

    <div>
        gender:<br>
        Male:<input type="checkbox" id="Male" onclick="updateFilter()"><br>
        Female:<input type="checkbox" id="Female" onclick="updateFilter()"><br>
    </div>

    <div>
        price range:<br>
        less than 100:<input type="radio" name="priceRange" id="l100" value="1" onclick="updateFilter()"><br>
        100-200:<input type="radio" name="priceRange" id="100t200" value="2" onclick="updateFilter()"><br>
        200-300:<input type="radio" name="priceRange" id="200t300" value="3" onclick="updateFilter()"><br>
        300-400:<input type="radio" name="priceRange" id="300t400" value="4" onclick="updateFilter()"><br>
        400-500:<input type="radio" name="priceRange" id="400t500" value="5" onclick="updateFilter()"><br>
        greater than 500:<input type="radio" name="priceRange" id="g500" value="6" onclick="updateFilter()"><br>
    </div>

</div>

<div>
    price:
<!--    <select id="sort_options" onchange="updateSort()">-->
<!--        <option>descending</option>-->
<!--        <option>ascending</option>-->
<!--        <option selected>Default</option>-->
<!--    </select>-->

    <select id="priceOrder" onchange="updateFilter()">
        <option>descending</option>
        <option>ascending</option>
        <option selected>Default</option>
    </select>
</div>

<div id="content" class="content">

</div>
<body>
<script>
    // var items=null;

    // function updateSort() {
    //     if(items==null){
    //         return;
    //     }
    //
    //     if(items.length==0){
    //         return;
    //     }
    //
    //     var index = document.getElementById("sort_options").selectedIndex;
    //
    //     var tmp=items.slice();
    //
    //     if (index == 0) {
    //         tmp.sort(function (a,b){
    //             return parseFloat(b.children[2].innerText.trim().substring(1))-parseFloat(a.children[2].innerText.trim().substring(1));
    //         })
    //     } else if (index == 1) {
    //         tmp.sort(function (a,b){
    //             return parseFloat(a.children[2].innerText.trim().substring(1))-parseFloat(b.children[2].innerText.trim().substring(1));
    //         })
    //     }
    //
    //     for(var i of tmp){
    //         document.getElementById("content").appendChild(i);
    //     }
    // }

    function updateFilter() {

        var brand = [];
        if ($("#Nike").prop('checked')) {
                brand.push("Nike");
        }
        if ($("#Supreme").prop('checked')) {
            brand.push("Supreme");
        }
        if ($("#Prada").prop('checked')) {
            brand.push("Prada");
        }
        if ($("#Gucci").prop('checked')) {
            brand.push("Gucci");
        }

        var size= [];
        if ($("#S").prop('checked')) {
            size.push("1");
        }
        if ($("#M").prop('checked')) {
            size.push("2");
        }
        if ($("#L").prop('checked')) {
            size.push("3");
        }
        if ($("#XL").prop('checked')) {
            size.push("4");
        }

        var condition=[];
        if ($("#New").prop('checked')) {
            condition.push("1");
        }
        if ($("#LikeNew").prop('checked')) {
            condition.push("2");
        }
        if ($("#VeryGood").prop('checked')) {
            condition.push("3");
        }
        if ($("#Good").prop('checked')) {
            condition.push("4");
        }
        if ($("#Fair").prop('checked')) {
            condition.push("5");
        }
        var gender =[];
        if ($("#Male").prop('checked')) {
            gender.push("1");
        }
        if ($("#Female").prop('checked')) {
            gender.push("2");
        }

        // <div>
        //     price range:<br>
        //     less than 100:<input type="checkbox" id="l100" onClick="updateFilter()"><br>
        //     100-200:<input type="checkbox" id="100t200" onClick="updateFilter()"><br>
        //     200-300:<input type="checkbox" id="200t300" onClick="updateFilter()"><br>
        //     300-400:<input type="checkbox" id="300t400" onClick="updateFilter()"><br>
        //     400-500:<input type="checkbox" id="400t500" onClick="updateFilter()"><br>
        //     greater than 500:<input type="checkbox" id="g500" onClick="updateFilter()"><br>
        // </div>

        var priceRange;
        var val1=$('input:radio[id="l100"]:checked').val();
        if (val1!=null) {
            priceRange=1;
        }

        var val2=$('input:radio[id="100t200"]:checked').val();
        if (val2!=null) {
            priceRange=2;
        }

        var val3=$('input:radio[id="200t300"]:checked').val();
        if (val3!=null) {
            priceRange=3;
        }


        var val4=$('input:radio[id="300t400"]:checked').val();
        if (val4!=null) {
            priceRange=4;
        }


        var val5=$('input:radio[id="400t500"]:checked').val();
        if (val5!=null) {
            priceRange=5;
        }


        var val6=$('input:radio[id="g500"]:checked').val();
        if (val6!=null) {
            priceRange=6;
        }



        var price;
        var selectedIndex = document.getElementById("priceOrder").selectedIndex;
        price=selectedIndex;




        var vars = window.location.search.substring(1);
        var id = vars.substring(vars.lastIndexOf("=") + 1).trim();

        $("#content").empty();
        $.ajax({
            url: "/products/getProductByFilter",
            data: "category="+id+"&brands="+brand+"&sizes="+size+"&conditions="+condition+"&genders="+gender+"&priceOrder="+price+"&priceRange="+priceRange,
            type: "post",
            dataType: "json",

            success:function (json) {
                if(json.state==200) {
                    var list = json.data;
                    alert(list.length)
                    for (var i = 0; i < list.length; i++) {
                        var html = '<div>'
                            + '<div><img src="#{image}_1.png"/></div>'
                            + '<div><a href="product.html?id=#{id}">#{title}</a></div>'
                            + '<div>$#{price}</div>'
                            + '<div>#{brand}</div>'
                            + '<div>#{size}</div>'
                            + '</div>';

                        html=html.replace("#{title}", list[i].title);
                        html=html.replace("#{price}",list[i].price);
                        html=html.replace("#{brand}", list[i].brand);
                        if(list[i].size == "1"){
                            var size = "S";
                        }else if(list[i].size == "2"){
                            var size = "M";
                        }else if(list[i].size == "3"){
                            var size = "L";
                        }else if(list[i].size == "4"){
                            var size = "XL";
                        }
                        html=html.replace("#{size}", size);
                        html=html.replace("#{image}", list[i].image);
                        html=html.replace("#{id}", list[i].id);
                        $("#content").append(html);
                    }

                    // items = new Array();
                    // var content = document.getElementById("content");
                    // for (var i = 0; i < content.children.length; i++) {
                    //     items.push(content.children[i]);
                    // }
                    //
                    // updateSort();

                }else if (json.state == 8001) {
                    location.href = "index.html";
                } else {
                    alert("Failed to obtain commodity information. Procedure！" + json.message);
                }
            }
        })

    }



    $(document).ready(function (){

        var vars = window.location.search.substring(1);
        var id=vars.substring(vars.lastIndexOf("=")+1).trim();
        alert("vars= "+id);

        $.ajax({
          url:"/products/getProductByCategory",
          data:"category="+id,
          type:"post",
          dataType:"json",

          success:function (json) {
              if (json.state == 200) {
                  var list = json.data;
                  alert(list.length)
                  for (var i = 0; i < list.length; i++) {
                      var html = '<div>'
                          + '<div><img src="#{image}_1.png"/></div>'
                          + '<div><a href="product.html?id=#{id}">#{title}</a></div>'
                          + '<div>$#{price}</div>'
                          + '<div>#{brand}</div>'
                          + '<div>#{size}</div>'
                          + '</div>';

                      html = html.replace("#{title}", list[i].title);
                      html = html.replace("#{price}", list[i].price);
                      html = html.replace("#{brand}", list[i].brand);
                      if (list[i].size == "1") {
                          var size = "S";
                      } else if (list[i].size == "2") {
                          var size = "M";
                      } else if (list[i].size == "3") {
                          var size = "L";
                      } else if (list[i].size == "4") {
                          var size = "XL";
                      }
                      html = html.replace("#{size}", size);
                      html = html.replace("#{image}", list[i].image);
                      html = html.replace("#{id}", list[i].id);
                      $("#content").append(html);
                  }

                  // items = new Array();
                  // var content = document.getElementById("content");
                  // for (var i = 0; i < content.children.length; i++) {
                  //     items.push(content.children[i]);
                  // }

                  // updateSort();

              } else if (json.state == 8001) {
                  location.href = "index.html";
              } else {
                  alert("Failed to obtain commodity information. Procedure！" + json.message);
              }
          }
        })
    })
</script>
</body>
</html>